# ImmutableX Javascript SDK

This repository contains everything partners need to launch the link, and make transactions on IMX. For all documentation needs, please goto [docs.x.immutable.com](https://docs.x.immutable.com/)

## Available Scripts

In the project directory, you can run:

#### `npm run lint`

Runs the linting against the whole package. This checks the package source code using:

- typescript typecheck, then
- eslint

#### `npm run test`

Runs all jest tests once. To run tests in watch mode, use `npm run test:watch`

#### `npm run build`

Builds the package for production to the `dist` folder using rollup.

#### `npm run start:lab`

Runs an internal mini webpack react typescript project called "Lab". The Lab allows us to test out sdk and lib changes internally, in isolation.

# CHANGELOG

### 1.1.0

Includes royalty fees by default in the following endpoints:

- `link.getOrder`
- `link.getAssets`
- `link.getOrder`
- `link.getAsset`
- `link.createOrder`
- `link.createTrade`

which will include a fee body with fee information (if exists).

### 1.0.2

- Updated responses for link methods
  - `link.prepareWithdrawal` now contains `withdrawalId`
  - `link.completeWithdrawal` now contains `transactionId`

### 1.0.0

1.0.0 marks the first public release of @imtbl/imx-sdk. Bundled in this release, are the following features:

- Transfer functionality has been refactored to support multiple transfers at once [imx-docs](https://docs.x.immutable.com/docs/linktransfer)

### 1.1.175 (migrated from @imtbl/imx-link)

There was a breaking change related to user registration, the `ImmutableXClient.build()` function now requires a new `registrationContractAddress` parameter which should be set to the following, depending on the environment:

- Ropsten: 0x6C21EC8DE44AE44D0992ec3e2d9f1aBb6207D864
- Mainnet: 0x72a06bf2a1CE5e39cBA06c0CAb824960B587d64c

### 2.0.1 (migrated from @imtbl/link-lib)

Refactored buy method (link.buy). This newly refactored method allows multiple orders to be bought at once [jira-ticket](https://immutable.atlassian.net/browse/IMX-3212)

### 1.0.148 (migrated from @imbtl/link-sdk)

- The Link constructor now supports a second set of options. The presence of these options will convert the link web popup into an iframe - when ever SDK methods are excecuted. [jira-ticket](https://immutable.atlassian.net/browse/IMX-3170)
- The iframe container may be customised by partners using the following [options](https://github.com/immutable/imx-link/blob/f2cddb585392c4412c4b8d3cab5f34cd92b3ab23/packages/sdk/src/types/iframe.ts#L19)
- Link `ImmutableGetSignableOrderResultCodec` now includes fees returned from the order response for fee support [link to ticket](https://github.com/immutable/imx-sdk-js/pull/2)
- Add Starkware native fee solution into the order signature for fee support [link to ticket](https://github.com/immutable/imx-sdk-js/pull/3)

# Use the imx-sdk-js repo locally inside of other imx applications

To provide this functionality, we are leaning on a nifty little workspaces tool, called [yalc](https://github.com/wclr/yalc).

Here are some example steps to achieve a common local workflow:

1. Checkout `imx-link` and `imx-sdk-js` repos
2. install yalc globally (`npm i yalc -g`)
3. make desired changes to `imx-sdk-js` repo, then as a final step, build and publish the changes to yalcâ€™s local installations: `npm run build; yalc publish`
4. inside of imx-link repo, simply run `yalc link @imtbl/imx-sdk`
5. run your local build of link normally (eg: `npm run start`)
6. You should now see that the local build is serving from your local copy of `imx-sdk-js` - and not the npm copy.
7. rinse and repeat after each set of `imx-sdk-js` changes

# Docs for Maintainers

* [Deployment](./docs/deployment.md)